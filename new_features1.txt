New codes to be merged with master
